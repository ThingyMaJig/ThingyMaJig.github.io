---
excerpt: "<p>The first test is a valid email address test. The second test is if an
  account exists for that email address. The third is if the username, generated by
  the &quot;user&quot; part of the email address, exists. If there are any issues,
  the &quot;error&quot; is logged into and array and printed at the end.</p>\r\n<p>As
  the function goes along, a user is saves with the user part of the email address
  as their name, a random 6 character password and the email address as the contact
  address. In this example, it also give the user role number 3, which was our &quot;subscriber&quot;
  role.</p>"
categories:
- tip
- programming
- howto
- drupal
layout: post
title: How to import users into Drupal using Devel
created: 1232040188
permalink: blog/15-01-2009/how-import-users-into-drupal-using-devel
---
<p>The first test is a valid email address test. The second test is if an account exists for that email address. The third is if the username, generated by the &quot;user&quot; part of the email address, exists. If there are any issues, the &quot;error&quot; is logged into and array and printed at the end.</p>
<p>As the function goes along, a user is saves with the user part of the email address as their name, a random 6 character password and the email address as the contact address. In this example, it also give the user role number 3, which was our &quot;subscriber&quot; role.</p>
<p>The result is a bunch of username, password and email addresses printed out and a bunch of users generated for you.</p>
<p><strong>DISCLAIMER:</strong> <em>Please backup your database before you run this, just in case!</em></p>
<pre language="php">
$emails = array('webmaster@thingy-ma-jig.co.uk', 'dont@email.me', 'joe.bloggs@blah.com', 'foo.bar.com');
$errors = array();
foreach ($emails as $email) {
  if (!valid_email_address($email)) {
    $errors[] = "Address '{$email}' is invalid";
  }   elseif ($user = user_load(array('mail' => $email))) {
    $errors[] = "User '{$user->name}' with email address '{$user->mail}' is already a subscriber";
  }   else {
    $username = array_shift(explode('@', $email));
    if ($user = user_load(array('name' => $username))) {
      $errors[] = "Username '{$username}' already exists";
    }
    else {
      $password = user_password(6);
      $user = array(
        'name' => $username,
        'pass' => $password,
        'mail' => $email,
        'roles' => array( 3 => 3 ),
        'status' => 1,
      );
      $user = user_save(NULL, $user);
      echo "{$username}, {$password}, {$email}\n";
    }
  }
}
echo implode("\n", $errors);
</pre>
<p>I hope this saves someone a little time.</p>
